(function(b){b.fn.extend({fullscreenimage:function(e){e=b.extend({maxUpscale:1,rasterImg:"",showRaster:false,vAlign:"center"},e);var a={},i=b.browser.msie&&b.browser.version<="6.0";return this.each(function(){function j(){function k(){var d;if(c.vAlign=="top")d="0px";else if(c.vAlign=="center")d=(a.wh-a.ich)/2+"px";else if(c.vAlign=="bottom")d="-"+(a.ich-a.wh)+"px";a.i.css({position:a.pos,"z-index":-1,width:a.icw,height:a.ich,left:(a.ww-a.icw)/2+"px",top:d})}function l(d){d=="height"&&a.ih*a.maxUpscale<=
a.ich||d=="width"&&a.iw*a.maxUpscale<=a.icw?a.rasterContainer.show():a.rasterContainer.hide()}a.ww=b(window).width();a.wh=b(window).height();a.windowRatio=a.ww/a.wh;if(a.windowRatio>a.iRatio){var f=a.ww,g=a.ww/a.iRatio;a.icw=f;a.ich=g;k();c.showRaster&&l("width")}else{g=a.wh;f=a.wh*a.iRatio;a.icw=f;a.ich=g;k();c.showRaster&&l("height")}}var c=e,h;h=this.nodeName=="IMG"?b(this):b(this).find("img").first();a.c=h.parent();a.i=h;a.iw=a.i.width();a.ih=a.i.height();a.iRatio=a.iw/a.ih;a.raster=c.rasterImg;
a.maxUpscale=c.maxUpscale;a.pos=i?"absolute":"fixed";if(c.showRaster)a.rasterContainer=b("<div />",{"class":"raster",css:{background:"url("+a.raster+") repeat top left",position:a.pos,top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:0}});a.c.css({zIndex:"-1",position:a.pos,top:0,left:0,width:"100%",height:i?b(window).height()+"px":"100%",overflow:"hidden"});c.showRaster&&a.rasterContainer.prependTo(a.c).hide();j();b(window).resize(j)})}})})(jQuery);
