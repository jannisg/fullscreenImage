(function($){$.fn.extend({fullscreenimage:function(options){var defaults={maxUpscale:1,rasterImg:"/static/img/raster.png",showRaster:true,vAlign:"center"};var options=$.extend(defaults,options);var FSI={};var ie6=($.browser.msie&&$.browser.version<="6.0");return this.each(function(){var o=options;var self;if(this.nodeName=="IMG"){self=$(this)}else{self=$(this).find("img").first()}FSI.c=self.parent();FSI.i=self;FSI.iw=FSI.i.width();FSI.ih=FSI.i.height();FSI.iRatio=FSI.iw/FSI.ih;FSI.raster=o.rasterImg;FSI.maxUpscale=o.maxUpscale;FSI.pos=(ie6?"absolute":"fixed");if(o.showRaster){FSI.rasterContainer=$("<div />",{"class":"raster",css:{background:"url("+FSI.raster+") repeat top left",position:FSI.pos,top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:0}})}FSI.c.css({zIndex:"-1",position:FSI.pos,top:0,left:0,width:"100%",height:"100%",overflow:"hidden"});if(o.showRaster){FSI.rasterContainer.prependTo(FSI.c).hide()}function fullscreenimage(){FSI.icw;FSI.ich;FSI.ww=$(window).width();FSI.wh=$(window).height();FSI.windowRatio=FSI.ww/FSI.wh;function pos(){var vAtop;if(o.vAlign=="top"){vAtop=0+"px"}else{if(o.vAlign=="center"){vAtop=(FSI.wh-FSI.ich)/2+"px"}else{if(o.vAlign=="bottom"){vAtop="-"+(FSI.ich-FSI.wh)+"px"}}}FSI.i.css({position:FSI.pos,"z-index":-1,width:FSI.icw,height:FSI.ich,left:((FSI.ww-FSI.icw)/2)+"px",top:vAtop})}function raster(axis){if(axis=="height"&&(FSI.ih*FSI.maxUpscale)<=FSI.ich||axis=="width"&&(FSI.iw*FSI.maxUpscale)<=FSI.icw){FSI.rasterContainer.show()}else{FSI.rasterContainer.hide()}}if(FSI.windowRatio>FSI.iRatio){var calcWidth=FSI.ww,calcHeight=FSI.ww/FSI.iRatio;FSI.icw=calcWidth;FSI.ich=calcHeight;pos();if(o.showRaster){raster("width")}}else{var calcHeight=FSI.wh,calcWidth=FSI.wh*FSI.iRatio;FSI.icw=calcWidth;FSI.ich=calcHeight;pos();if(o.showRaster){raster("height")}}}fullscreenimage();$(window).resize(fullscreenimage)})}})})(jQuery);